<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OBS 采集页面</title>
    <style>
        body {
            background-color: rgba(0, 0, 0, 0);
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Inter', system-ui, sans-serif;
        }
        
        .strength-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            gap: 40px; /* 圆环之间的间距 */
        }
        
        .strength-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .strength-label {
            color: #ffffff;
            font-size: 32px; /* 增大标签字体 */
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            font-weight: bold;
        }
        
        /* 圆形进度条 */
        .strength-circle {
            position: relative;
            width: 180px;
            height: 180px;
        }
        
        .strength-value {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 48px; /* 增大数值字体 */
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }
        
        .strength-value span {
            font-size: 24px; /* 增大单位字体 */
            color: #cccccc;
            font-weight: normal;
        }
        
        svg {
            width: 100%;
            height: 100%;
        }
        
        /* 添加一些动画效果 */
        .strength-circle {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        /* 进度条颜色根据数值变化 */
        .strength-a-progress {
            stroke: #165DFF;
        }
        
        .strength-b-progress {
            stroke: #F53F3F;
        }
    </style>
</head>
<body>
    <div class="strength-container">
        <div class="strength-item">
            <div class="strength-label">通道 A</div>
            <div class="strength-circle">
                <svg viewBox="0 0 100 100">
                    <!-- 背景圆环 -->
                    <circle cx="50" cy="50" r="45" fill="none" stroke="#e5e7eb" stroke-width="8"></circle>
                    <!-- 进度圆环 -->
                    <circle cx="50" cy="50" r="45" fill="none" stroke="#165DFF" stroke-width="8"
                        stroke-dasharray="283" stroke-dashoffset="283" stroke-linecap="round"
                        transform="rotate(-90 50 50)" id="strength-a-circle" class="strength-a-progress"></circle>
                </svg>
                <div class="strength-value">
                    <span id="strength-a-value">0</span>
                </div>
            </div>
        </div>
        
        <div class="strength-item">
            <div class="strength-label">通道 B</div>
            <div class="strength-circle">
                <svg viewBox="0 0 100 100">
                    <!-- 背景圆环 -->
                    <circle cx="50" cy="50" r="45" fill="none" stroke="#e5e7eb" stroke-width="8"></circle>
                    <!-- 进度圆环 -->
                    <circle cx="50" cy="50" r="45" fill="none" stroke="#F53F3F" stroke-width="8"
                        stroke-dasharray="283" stroke-dashoffset="283" stroke-linecap="round"
                        transform="rotate(-90 50 50)" id="strength-b-circle" class="strength-b-progress"></circle>
                </svg>
                <div class="strength-value">
                    <span id="strength-b-value">0</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 更新圆形进度条
        function updateCircleProgress(circleId, value, maxValue) {
            const circle = document.getElementById(circleId);
            const radius = 45;
            const circumference = 2 * Math.PI * radius;
            const progress = maxValue > 0 ? value / maxValue : 0;
            const offset = circumference * (1 - Math.min(progress, 1));
            circle.style.strokeDashoffset = offset;
        }
        
        // 获取并更新数据
        async function updateData() {
            try {
                const response = await fetch('http://localhost:8000/api/status');
                const data = await response.json();
                
                // 更新通道A - 显示当前强度，使用max_strength_A作为最大值
                document.getElementById('strength-a-value').textContent = data.strength_a;
                updateCircleProgress('strength-a-circle', data.strength_a, data.max_strength_A);
                
                // 更新通道B - 显示当前强度，使用max_strength_B作为最大值
                document.getElementById('strength-b-value').textContent = data.strength_b;
                updateCircleProgress('strength-b-circle', data.strength_b, data.max_strength_B);
            } catch (error) {
                console.error('获取数据失败:', error);
            }
        }
        
        // 每100毫秒更新一次数据
        setInterval(updateData, 100);
        
        // 页面加载完成后立即获取一次数据
        updateData();
    </script>
</body>
</html>